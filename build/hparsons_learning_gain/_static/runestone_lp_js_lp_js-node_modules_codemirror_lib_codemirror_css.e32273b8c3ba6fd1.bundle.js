(self["webpackChunkWebComponents"] = self["webpackChunkWebComponents"] || []).push([["runestone_lp_js_lp_js-node_modules_codemirror_lib_codemirror_css"],{

/***/ 28902:
/*!*************************************************!*\
  !*** ./node_modules/codemirror/mode/gas/gas.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: https://codemirror.net/5/LICENSE

(function(mod) {
  if (true) // CommonJS
    mod(__webpack_require__(/*! ../../lib/codemirror */ 4631));
  else {}
})(function(CodeMirror) {
"use strict";

CodeMirror.defineMode("gas", function(_config, parserConfig) {
  'use strict';

  // If an architecture is specified, its initialization function may
  // populate this array with custom parsing functions which will be
  // tried in the event that the standard functions do not find a match.
  var custom = [];

  // The symbol used to start a line comment changes based on the target
  // architecture.
  // If no architecture is pased in "parserConfig" then only multiline
  // comments will have syntax support.
  var lineCommentStartSymbol = "";

  // These directives are architecture independent.
  // Machine specific directives should go in their respective
  // architecture initialization function.
  // Reference:
  // http://sourceware.org/binutils/docs/as/Pseudo-Ops.html#Pseudo-Ops
  var directives = {
    ".abort" : "builtin",
    ".align" : "builtin",
    ".altmacro" : "builtin",
    ".ascii" : "builtin",
    ".asciz" : "builtin",
    ".balign" : "builtin",
    ".balignw" : "builtin",
    ".balignl" : "builtin",
    ".bundle_align_mode" : "builtin",
    ".bundle_lock" : "builtin",
    ".bundle_unlock" : "builtin",
    ".byte" : "builtin",
    ".cfi_startproc" : "builtin",
    ".comm" : "builtin",
    ".data" : "builtin",
    ".def" : "builtin",
    ".desc" : "builtin",
    ".dim" : "builtin",
    ".double" : "builtin",
    ".eject" : "builtin",
    ".else" : "builtin",
    ".elseif" : "builtin",
    ".end" : "builtin",
    ".endef" : "builtin",
    ".endfunc" : "builtin",
    ".endif" : "builtin",
    ".equ" : "builtin",
    ".equiv" : "builtin",
    ".eqv" : "builtin",
    ".err" : "builtin",
    ".error" : "builtin",
    ".exitm" : "builtin",
    ".extern" : "builtin",
    ".fail" : "builtin",
    ".file" : "builtin",
    ".fill" : "builtin",
    ".float" : "builtin",
    ".func" : "builtin",
    ".global" : "builtin",
    ".gnu_attribute" : "builtin",
    ".hidden" : "builtin",
    ".hword" : "builtin",
    ".ident" : "builtin",
    ".if" : "builtin",
    ".incbin" : "builtin",
    ".include" : "builtin",
    ".int" : "builtin",
    ".internal" : "builtin",
    ".irp" : "builtin",
    ".irpc" : "builtin",
    ".lcomm" : "builtin",
    ".lflags" : "builtin",
    ".line" : "builtin",
    ".linkonce" : "builtin",
    ".list" : "builtin",
    ".ln" : "builtin",
    ".loc" : "builtin",
    ".loc_mark_labels" : "builtin",
    ".local" : "builtin",
    ".long" : "builtin",
    ".macro" : "builtin",
    ".mri" : "builtin",
    ".noaltmacro" : "builtin",
    ".nolist" : "builtin",
    ".octa" : "builtin",
    ".offset" : "builtin",
    ".org" : "builtin",
    ".p2align" : "builtin",
    ".popsection" : "builtin",
    ".previous" : "builtin",
    ".print" : "builtin",
    ".protected" : "builtin",
    ".psize" : "builtin",
    ".purgem" : "builtin",
    ".pushsection" : "builtin",
    ".quad" : "builtin",
    ".reloc" : "builtin",
    ".rept" : "builtin",
    ".sbttl" : "builtin",
    ".scl" : "builtin",
    ".section" : "builtin",
    ".set" : "builtin",
    ".short" : "builtin",
    ".single" : "builtin",
    ".size" : "builtin",
    ".skip" : "builtin",
    ".sleb128" : "builtin",
    ".space" : "builtin",
    ".stab" : "builtin",
    ".string" : "builtin",
    ".struct" : "builtin",
    ".subsection" : "builtin",
    ".symver" : "builtin",
    ".tag" : "builtin",
    ".text" : "builtin",
    ".title" : "builtin",
    ".type" : "builtin",
    ".uleb128" : "builtin",
    ".val" : "builtin",
    ".version" : "builtin",
    ".vtable_entry" : "builtin",
    ".vtable_inherit" : "builtin",
    ".warning" : "builtin",
    ".weak" : "builtin",
    ".weakref" : "builtin",
    ".word" : "builtin"
  };

  var registers = {};

  function x86(_parserConfig) {
    lineCommentStartSymbol = "#";

    registers.al  = "variable";
    registers.ah  = "variable";
    registers.ax  = "variable";
    registers.eax = "variable-2";
    registers.rax = "variable-3";

    registers.bl  = "variable";
    registers.bh  = "variable";
    registers.bx  = "variable";
    registers.ebx = "variable-2";
    registers.rbx = "variable-3";

    registers.cl  = "variable";
    registers.ch  = "variable";
    registers.cx  = "variable";
    registers.ecx = "variable-2";
    registers.rcx = "variable-3";

    registers.dl  = "variable";
    registers.dh  = "variable";
    registers.dx  = "variable";
    registers.edx = "variable-2";
    registers.rdx = "variable-3";

    registers.si  = "variable";
    registers.esi = "variable-2";
    registers.rsi = "variable-3";

    registers.di  = "variable";
    registers.edi = "variable-2";
    registers.rdi = "variable-3";

    registers.sp  = "variable";
    registers.esp = "variable-2";
    registers.rsp = "variable-3";

    registers.bp  = "variable";
    registers.ebp = "variable-2";
    registers.rbp = "variable-3";

    registers.ip  = "variable";
    registers.eip = "variable-2";
    registers.rip = "variable-3";

    registers.cs  = "keyword";
    registers.ds  = "keyword";
    registers.ss  = "keyword";
    registers.es  = "keyword";
    registers.fs  = "keyword";
    registers.gs  = "keyword";
  }

  function armv6(_parserConfig) {
    // Reference:
    // http://infocenter.arm.com/help/topic/com.arm.doc.qrc0001l/QRC0001_UAL.pdf
    // http://infocenter.arm.com/help/topic/com.arm.doc.ddi0301h/DDI0301H_arm1176jzfs_r0p7_trm.pdf
    lineCommentStartSymbol = "@";
    directives.syntax = "builtin";

    registers.r0  = "variable";
    registers.r1  = "variable";
    registers.r2  = "variable";
    registers.r3  = "variable";
    registers.r4  = "variable";
    registers.r5  = "variable";
    registers.r6  = "variable";
    registers.r7  = "variable";
    registers.r8  = "variable";
    registers.r9  = "variable";
    registers.r10 = "variable";
    registers.r11 = "variable";
    registers.r12 = "variable";

    registers.sp  = "variable-2";
    registers.lr  = "variable-2";
    registers.pc  = "variable-2";
    registers.r13 = registers.sp;
    registers.r14 = registers.lr;
    registers.r15 = registers.pc;

    custom.push(function(ch, stream) {
      if (ch === '#') {
        stream.eatWhile(/\w/);
        return "number";
      }
    });
  }

  var arch = (parserConfig.architecture || "x86").toLowerCase();
  if (arch === "x86") {
    x86(parserConfig);
  } else if (arch === "arm" || arch === "armv6") {
    armv6(parserConfig);
  }

  function nextUntilUnescaped(stream, end) {
    var escaped = false, next;
    while ((next = stream.next()) != null) {
      if (next === end && !escaped) {
        return false;
      }
      escaped = !escaped && next === "\\";
    }
    return escaped;
  }

  function clikeComment(stream, state) {
    var maybeEnd = false, ch;
    while ((ch = stream.next()) != null) {
      if (ch === "/" && maybeEnd) {
        state.tokenize = null;
        break;
      }
      maybeEnd = (ch === "*");
    }
    return "comment";
  }

  return {
    startState: function() {
      return {
        tokenize: null
      };
    },

    token: function(stream, state) {
      if (state.tokenize) {
        return state.tokenize(stream, state);
      }

      if (stream.eatSpace()) {
        return null;
      }

      var style, cur, ch = stream.next();

      if (ch === "/") {
        if (stream.eat("*")) {
          state.tokenize = clikeComment;
          return clikeComment(stream, state);
        }
      }

      if (ch === lineCommentStartSymbol) {
        stream.skipToEnd();
        return "comment";
      }

      if (ch === '"') {
        nextUntilUnescaped(stream, '"');
        return "string";
      }

      if (ch === '.') {
        stream.eatWhile(/\w/);
        cur = stream.current().toLowerCase();
        style = directives[cur];
        return style || null;
      }

      if (ch === '=') {
        stream.eatWhile(/\w/);
        return "tag";
      }

      if (ch === '{') {
        return "bracket";
      }

      if (ch === '}') {
        return "bracket";
      }

      if (/\d/.test(ch)) {
        if (ch === "0" && stream.eat("x")) {
          stream.eatWhile(/[0-9a-fA-F]/);
          return "number";
        }
        stream.eatWhile(/\d/);
        return "number";
      }

      if (/\w/.test(ch)) {
        stream.eatWhile(/\w/);
        if (stream.eat(":")) {
          return 'tag';
        }
        cur = stream.current().toLowerCase();
        style = registers[cur];
        return style || null;
      }

      for (var i = 0; i < custom.length; i++) {
        style = custom[i](ch, stream, state);
        if (style) {
          return style;
        }
      }
    },

    lineComment: lineCommentStartSymbol,
    blockCommentStart: "/*",
    blockCommentEnd: "*/"
  };
});

});


/***/ }),

/***/ 2013:
/*!*******************************!*\
  !*** ./runestone/lp/js/lp.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _common_js_runestonebase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/js/runestonebase */ 2568);
/* harmony import */ var codemirror__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! codemirror */ 4631);
/* harmony import */ var codemirror__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(codemirror__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var codemirror_mode_gas_gas_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! codemirror/mode/gas/gas.js */ 28902);
/* harmony import */ var codemirror_mode_gas_gas_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_gas_gas_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var codemirror_mode_python_python_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! codemirror/mode/python/python.js */ 5321);
/* harmony import */ var codemirror_mode_python_python_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_python_python_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var codemirror_mode_javascript_javascript_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! codemirror/mode/javascript/javascript.js */ 96876);
/* harmony import */ var codemirror_mode_javascript_javascript_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_javascript_javascript_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var codemirror_mode_sql_sql_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! codemirror/mode/sql/sql.js */ 54086);
/* harmony import */ var codemirror_mode_sql_sql_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_sql_sql_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var codemirror_mode_clike_clike_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! codemirror/mode/clike/clike.js */ 99762);
/* harmony import */ var codemirror_mode_clike_clike_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_clike_clike_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var codemirror_mode_octave_octave_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! codemirror/mode/octave/octave.js */ 15734);
/* harmony import */ var codemirror_mode_octave_octave_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_octave_octave_js__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var codemirror_lib_codemirror_css__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! codemirror/lib/codemirror.css */ 90464);
// .. Copyright (C) 2017 Bryan A. Jones.
//
//    This file is part of E-Book Binder.
//
//    E-Book Binder is free software: you can redistribute it and/or modify it
//    under the terms of the GNU General Public License as published by the Free
//    Software Foundation, either version 3 of the License, or (at your option)
//    any later version.
//
//    E-Book Binder is distributed in the hope that it will be useful, but WITHOUT
//    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
//    FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
//    details.
//
//    You should have received a copy of the GNU General Public License along
//    with E-Book Binder.  If not, see <http://www.gnu.org/licenses/>.
//
// .. highlight:: javascript
//
// **************************************************************************************
// |docname| - JavaScript functions supporting immediate feedback to in-browser questions
// **************************************************************************************













// Constructor
// ===========
// Object containing all instances of LP problems. (I assume there is just one per page.)
window.LPList = {};

// FITB constructor
class LP extends _common_js_runestonebase__WEBPACK_IMPORTED_MODULE_0__["default"] {
    constructor(opts) {
        super(opts);
        this.useRunestoneServices = opts.useRunestoneServices;
        // Store the DOM element (the input) for the "Test" button.
        this.element = opts.orig;
        this.containerDiv = this.element;
        this.divid = this.element.id;
        // Store the DOM element (the textarea) where compile results will be displayed.
        this.resultElement = $(this.element).siblings(".lp-result");
        // Store the DOM element (a div) where feedback will be displayed.
        this.feedbackElement = $(this.element)
            .siblings(".lp-feedback")
            .children("div");
        // Use a nice editor.
        this.textAreas = [];
        this.initTextAreas();
        // Handle clicks to the "Save and run" button.
        let that = this;
        $(this.element).click((eventObject) =>
            that.onSaveAndRun(eventObject).then(null)
        );
        this.checkServer("lp_build", true);
    }

    // Look for each code snippet (a textarea). Make it a nice CodeMirror editor.
    initTextAreas(is_read_only = false) {
        let that = this;
        // Select only textareas that haven't been initialized with CodeMirror (which sets style="display:none" on the textarea).
        $('textarea.code_snippet:not([style="display: none;"])').each(function (index, element) {
            let editor = codemirror__WEBPACK_IMPORTED_MODULE_1___default().fromTextArea(element, {
                lineNumbers: true,
                mode: $(that.element).attr("data-lang"),
                indentUnit: 4,
                matchBrackets: true,
                readOnly: is_read_only,
                autoMatchParens: true,
                extraKeys: { Tab: "indentMore", "Shift-Tab": "indentLess" },
            });
            // Make the editor resizable.
            $(editor.getWrapperElement()).resizable({
                resize: function () {
                    editor.setSize($(this).width(), $(this).height());
                    editor.refresh();
                },
            });
            // Keep track of it.
            that.textAreas.push(editor);
        });
    }

    // Data structures:
    //
    // Format of data stored locally and on the server*::
    //
    //  -   answer: JSON-encoded string containing {
    //          code_snippets: [
    //              str, snippet 1, ...
    //          ],
    //          (optional) resultString: str, output from build.
    //      }
    //  -   correct: (optional) float, a percentage from 0 to 100.
    //  -   timestamp: date/time in UTC.
    //
    // Format of data sent to the server*::
    //
    //  -   answer: JSON-encoded string containing only the code_snippets
    //          array, not resultString. There's no point in sending the
    //          previous resultString, since the server will compute a new
    //          one.
    //  -   event: "lp_build"
    //  -   act: "", since the useinfo table requires it. It's not
    //          otherwise used.
    //  -   path: str, giving the relative path to this web page. Used
    //          to find the source code which produced this page in order
    //          to do snippet replacement.
    //  -   div_id: str, the div_id of this component.
    //
    // Format of data received from the server::
    //
    //  If there was an error:
    //  -   errors: [
    //          str, error message 1, ...
    //      ]
    //
    //  Otherwise:
    //  -   answer: JSON-encoded string containing {
    //          resultString: str, output from build.
    //          Note that the code_snippets aren't sent back, to save
    //              bandwidth.
    //      }
    //  -   correct: float, a percentage from 0 to 100.
    //  -   timestamp: str, the server's timestamp.
    //
    // * For simplicity, I omitted the common fields (course, etc.) and discussed only fields unique to this component.

    async onSaveAndRun(_eventObject) {
        // Prevent multiple click while the build is running.
        $(this.element).attr("disabled", true);
        $(this.resultElement).val("Building...");
        $(this.feedbackElement).text("").attr("");
        // Since the Save and run button was clicked, we assume the code snippets have been changed; therefore, don't store ``correct`` or ``answer.resultString`` because they are out of date.
        //
        // Store the answer as a string, since this is what goes in to / comes out from the database. We have to translate this back to a data structure when restoring from the db or local storage.
        let code_snippets = this.textareasToData();
        this.setLocalStorage({
            answer: { code_snippets: code_snippets },
            timestamp: new Date(),
        });
        // Store the answer that the server returns, which includes additional data (correct/incorrect, feedback from the build, etc.).
        let serverAnswer;
        try {
            serverAnswer = await this.logBookEvent({
                event: "lp_build",
                answer: JSON.stringify(code_snippets),
                // This is required by useinfo, but not used.
                act: "",
                // Find the relative path to this web page. Slice off the leading ``/``.
                path: window.location.href
                    .replace(eBookConfig.app, "")
                    .slice(1),
                div_id: this.divid,
            });
        } catch (err) {
            $(this.feedbackElement)
                .val(`Error contacting server: {err}.`)
                .attr("class", "alert alert-danger");
            return;
        } finally {
            // Always re-enable the button after the server responds.
            $(this.element).attr("disabled", false);
        }
        serverAnswer = serverAnswer.detail;
        // The server doesn't return the ``code_snippets``, for efficiency. Include those. If an error was returned, note that there is no ``answer`` yet.
        if (!("answer" in serverAnswer)) {
            serverAnswer.answer = {};
        }
        serverAnswer.answer.code_snippets = code_snippets;
        this.displayAnswer(serverAnswer);
        this.setLocalStorage(serverAnswer);
    }

    // Given a single answer, display it.
    displayAnswer(data) {
        if ("errors" in data) {
            // Display any server-side errors. If this key is present, other keys won't be.
            $(this.feedbackElement)
                .text(data.errors.join("<br>"))
                .attr("class", "alert alert-danger");
        } else {
            // Display and color-code the results.
            $(this.resultElement).val(data.answer.resultString);
            if (data.correct == null) {
                $(this.feedbackElement)
                    .text("Response recorded.")
                    .attr("class", "alert alert-success");
            } else if (data.correct >= 100) {
                $(this.feedbackElement)
                    .text("Correct. Grade: " + data.correct + "%")
                    .attr("class", "alert alert-success");
            } else {
                $(this.feedbackElement)
                    .text("Incorrect. Grade: " + data.correct + "%")
                    .attr("class", "alert alert-danger");
            }
            // Scroll to the bottom of the results.
            $(this.resultElement).scrollTop(this.resultElement[0].scrollHeight);
        }
    }

    // Store the contents of each textarea into an array of strings.
    textareasToData() {
        return $.map(this.textAreas, function (obj, index) {
            // See https://codemirror.net/doc/manual.html#api.
            return obj.getValue();
        });
    }

    // Store an array of strings in ``data.code_snippets`` into each textarea.
    dataToTextareas(data) {
        // For places where textareas aren't provided (instructor grading interface, assignment page), create them. However, these aren't runnable, so disable the "Save and run" button. Assume this is the case when there are no textareas. Reasoning: the page containing the problem contains code intended to be intermingled with the student's answer. If that's not present, we can't build.
        if (!this.textAreas.length) {
            // The unusual case -- a problem not on its original page. Create textareas to display the code, then initialize them. Note that we can't simply create these in the constructor (which would be convenient) since we don't yet know how many code snippets are associated with the problem.
            $(this.element).before((data.answer.code_snippets || []).map(() => `<textarea class="code_snippet"></textarea><br />`));
            // Put CodeMirror in read-only mode.
            this.initTextAreas(true);
            // Disable the "Save and run" button.
            $(this.element).prop("disabled", true);
            // Now that we have textareas, let the usual case code run.
        }

        // The usual case -- a problem on its original page. Find all code snippet textareas.
        $(this.textAreas).each(function (index, value) {
            // Silently ignore if ``data.answer.code_snippets`` or ``data.answer.code_snippets[index]`` isn't defined.
            value.setValue((data.answer.code_snippets || "")[index] || "");
        });
        // Corner case TODO: if a problem is edited after students already submit code so that there are now fewer textareas, display these but don't save them when "Save and run" is pressed. This allows students to (hopefully) re-use code from now-discarded textareas.
    }

    // Restore answers from storage retrieval done in RunestoneBase.
    restoreAnswers(data) {
        // We store the answer as a JSON-encoded string in the db / local storage. Restore the actual data structure from it. Avoid exceptions if no data is available.
        data.answer = JSON.parse(data.answer || "{}");
        this.dataToTextareas(data);
        this.displayAnswer(data);
    }

    checkLocalStorage() {
        // Loads previous answers from local storage if they exist.
        var storedData;
        if (localStorage.length > 0) {
            var key = this.localStorageKey();
            var ex = localStorage.getItem(key);
            if (ex !== null) {
                try {
                    storedData = JSON.parse(ex);
                } catch (err) {
                    // error while parsing; likely due to bad value stored in storage
                    console.log(err.message);
                    localStorage.removeItem(key);
                    return;
                }
                this.restoreAnswers(storedData);
            }
        }
    }

    setLocalStorage(data) {
        // Make a shallow copy, so we can JSON-encode the code snippets (matching what comes from the server) without changing the original object.
        let data_clone = Object.assign({}, data);
        data_clone.answer =  JSON.stringify(data.answer);
        localStorage.setItem(this.localStorageKey(), JSON.stringify(data_clone));
    }
}

// Initialization
// ==============
// Find the custom HTML tags and execute our code on them.
$(document).on("runestone:login-complete", function () {
    $("[data-component=lp_build]").each(function (index) {
        try {
            window.LPList[this.id] = new LP({
                orig: this,
                useRunestoneServices: eBookConfig.useRunestoneServices,
            });
        } catch (err) {
            console.log(`Error rendering LP Problem ${this.id}`);
        }
    });
});

if (typeof window.component_factory === "undefined") {
    window.component_factory = {};
}
window.component_factory["lp_build"] = function (opts) {
    return new LP(opts);
};


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVuZXN0b25lX2xwX2pzX2xwX2pzLW5vZGVfbW9kdWxlc19jb2RlbWlycm9yX2xpYl9jb2RlbWlycm9yX2Nzcy5lMzIyNzNiOGMzYmE2ZmQxLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNLElBQXVEO0FBQzdELFFBQVEsbUJBQU8sQ0FBQyxnQ0FBc0I7QUFDdEMsT0FBTyxFQUdhO0FBQ3BCLENBQUM7QUFDRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUI7QUFDbkI7QUFDQTs7QUFFQSxtQkFBbUI7QUFDbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzQkFBc0IsbUJBQW1CO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRCxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hXRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVhOztBQUU2QztBQUN0QjtBQUNBO0FBQ007QUFDUTtBQUNkO0FBQ0k7QUFDRTtBQUNIOztBQUV2QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQixnRUFBYTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNELHlCQUF5Qiw4REFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDhDQUE4QztBQUMzRSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxR0FBcUc7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsOEJBQThCO0FBQ3BEO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFVBQVU7QUFDVjtBQUNBLGdEQUFnRCxJQUFJO0FBQ3BEO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRDtBQUNuRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFVBQVU7QUFDVixzREFBc0QsUUFBUTtBQUM5RDtBQUNBLEtBQUs7QUFDTCxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1dlYkNvbXBvbmVudHMvLi9ub2RlX21vZHVsZXMvY29kZW1pcnJvci9tb2RlL2dhcy9nYXMuanMiLCJ3ZWJwYWNrOi8vV2ViQ29tcG9uZW50cy8uL3J1bmVzdG9uZS9scC9qcy9scC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb2RlTWlycm9yLCBjb3B5cmlnaHQgKGMpIGJ5IE1hcmlqbiBIYXZlcmJla2UgYW5kIG90aGVyc1xuLy8gRGlzdHJpYnV0ZWQgdW5kZXIgYW4gTUlUIGxpY2Vuc2U6IGh0dHBzOi8vY29kZW1pcnJvci5uZXQvNS9MSUNFTlNFXG5cbihmdW5jdGlvbihtb2QpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PSBcIm9iamVjdFwiKSAvLyBDb21tb25KU1xuICAgIG1vZChyZXF1aXJlKFwiLi4vLi4vbGliL2NvZGVtaXJyb3JcIikpO1xuICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSAvLyBBTURcbiAgICBkZWZpbmUoW1wiLi4vLi4vbGliL2NvZGVtaXJyb3JcIl0sIG1vZCk7XG4gIGVsc2UgLy8gUGxhaW4gYnJvd3NlciBlbnZcbiAgICBtb2QoQ29kZU1pcnJvcik7XG59KShmdW5jdGlvbihDb2RlTWlycm9yKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuQ29kZU1pcnJvci5kZWZpbmVNb2RlKFwiZ2FzXCIsIGZ1bmN0aW9uKF9jb25maWcsIHBhcnNlckNvbmZpZykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gSWYgYW4gYXJjaGl0ZWN0dXJlIGlzIHNwZWNpZmllZCwgaXRzIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uIG1heVxuICAvLyBwb3B1bGF0ZSB0aGlzIGFycmF5IHdpdGggY3VzdG9tIHBhcnNpbmcgZnVuY3Rpb25zIHdoaWNoIHdpbGwgYmVcbiAgLy8gdHJpZWQgaW4gdGhlIGV2ZW50IHRoYXQgdGhlIHN0YW5kYXJkIGZ1bmN0aW9ucyBkbyBub3QgZmluZCBhIG1hdGNoLlxuICB2YXIgY3VzdG9tID0gW107XG5cbiAgLy8gVGhlIHN5bWJvbCB1c2VkIHRvIHN0YXJ0IGEgbGluZSBjb21tZW50IGNoYW5nZXMgYmFzZWQgb24gdGhlIHRhcmdldFxuICAvLyBhcmNoaXRlY3R1cmUuXG4gIC8vIElmIG5vIGFyY2hpdGVjdHVyZSBpcyBwYXNlZCBpbiBcInBhcnNlckNvbmZpZ1wiIHRoZW4gb25seSBtdWx0aWxpbmVcbiAgLy8gY29tbWVudHMgd2lsbCBoYXZlIHN5bnRheCBzdXBwb3J0LlxuICB2YXIgbGluZUNvbW1lbnRTdGFydFN5bWJvbCA9IFwiXCI7XG5cbiAgLy8gVGhlc2UgZGlyZWN0aXZlcyBhcmUgYXJjaGl0ZWN0dXJlIGluZGVwZW5kZW50LlxuICAvLyBNYWNoaW5lIHNwZWNpZmljIGRpcmVjdGl2ZXMgc2hvdWxkIGdvIGluIHRoZWlyIHJlc3BlY3RpdmVcbiAgLy8gYXJjaGl0ZWN0dXJlIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uLlxuICAvLyBSZWZlcmVuY2U6XG4gIC8vIGh0dHA6Ly9zb3VyY2V3YXJlLm9yZy9iaW51dGlscy9kb2NzL2FzL1BzZXVkby1PcHMuaHRtbCNQc2V1ZG8tT3BzXG4gIHZhciBkaXJlY3RpdmVzID0ge1xuICAgIFwiLmFib3J0XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5hbGlnblwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuYWx0bWFjcm9cIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmFzY2lpXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5hc2NpelwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuYmFsaWduXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5iYWxpZ253XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5iYWxpZ25sXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5idW5kbGVfYWxpZ25fbW9kZVwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuYnVuZGxlX2xvY2tcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmJ1bmRsZV91bmxvY2tcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmJ5dGVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmNmaV9zdGFydHByb2NcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmNvbW1cIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmRhdGFcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmRlZlwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuZGVzY1wiIDogXCJidWlsdGluXCIsXG4gICAgXCIuZGltXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5kb3VibGVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmVqZWN0XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5lbHNlXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5lbHNlaWZcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmVuZFwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuZW5kZWZcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmVuZGZ1bmNcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmVuZGlmXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5lcXVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmVxdWl2XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5lcXZcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmVyclwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuZXJyb3JcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmV4aXRtXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5leHRlcm5cIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmZhaWxcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmZpbGVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmZpbGxcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmZsb2F0XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5mdW5jXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5nbG9iYWxcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmdudV9hdHRyaWJ1dGVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmhpZGRlblwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuaHdvcmRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmlkZW50XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5pZlwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuaW5jYmluXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5pbmNsdWRlXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5pbnRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmludGVybmFsXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5pcnBcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmlycGNcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmxjb21tXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5sZmxhZ3NcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmxpbmVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmxpbmtvbmNlXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5saXN0XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5sblwiIDogXCJidWlsdGluXCIsXG4gICAgXCIubG9jXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5sb2NfbWFya19sYWJlbHNcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLmxvY2FsXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5sb25nXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5tYWNyb1wiIDogXCJidWlsdGluXCIsXG4gICAgXCIubXJpXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5ub2FsdG1hY3JvXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5ub2xpc3RcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLm9jdGFcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLm9mZnNldFwiIDogXCJidWlsdGluXCIsXG4gICAgXCIub3JnXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5wMmFsaWduXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5wb3BzZWN0aW9uXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5wcmV2aW91c1wiIDogXCJidWlsdGluXCIsXG4gICAgXCIucHJpbnRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnByb3RlY3RlZFwiIDogXCJidWlsdGluXCIsXG4gICAgXCIucHNpemVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnB1cmdlbVwiIDogXCJidWlsdGluXCIsXG4gICAgXCIucHVzaHNlY3Rpb25cIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnF1YWRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnJlbG9jXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5yZXB0XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5zYnR0bFwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuc2NsXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5zZWN0aW9uXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5zZXRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnNob3J0XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5zaW5nbGVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnNpemVcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnNraXBcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnNsZWIxMjhcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnNwYWNlXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5zdGFiXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi5zdHJpbmdcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnN0cnVjdFwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuc3Vic2VjdGlvblwiIDogXCJidWlsdGluXCIsXG4gICAgXCIuc3ltdmVyXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi50YWdcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnRleHRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnRpdGxlXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi50eXBlXCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi51bGViMTI4XCIgOiBcImJ1aWx0aW5cIixcbiAgICBcIi52YWxcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnZlcnNpb25cIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLnZ0YWJsZV9lbnRyeVwiIDogXCJidWlsdGluXCIsXG4gICAgXCIudnRhYmxlX2luaGVyaXRcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLndhcm5pbmdcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLndlYWtcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLndlYWtyZWZcIiA6IFwiYnVpbHRpblwiLFxuICAgIFwiLndvcmRcIiA6IFwiYnVpbHRpblwiXG4gIH07XG5cbiAgdmFyIHJlZ2lzdGVycyA9IHt9O1xuXG4gIGZ1bmN0aW9uIHg4NihfcGFyc2VyQ29uZmlnKSB7XG4gICAgbGluZUNvbW1lbnRTdGFydFN5bWJvbCA9IFwiI1wiO1xuXG4gICAgcmVnaXN0ZXJzLmFsICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMuYWggID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5heCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVheCA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yYXggPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5ibCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmJoICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMuYnggID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5lYnggPSBcInZhcmlhYmxlLTJcIjtcbiAgICByZWdpc3RlcnMucmJ4ID0gXCJ2YXJpYWJsZS0zXCI7XG5cbiAgICByZWdpc3RlcnMuY2wgID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5jaCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmN4ICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMuZWN4ID0gXCJ2YXJpYWJsZS0yXCI7XG4gICAgcmVnaXN0ZXJzLnJjeCA9IFwidmFyaWFibGUtM1wiO1xuXG4gICAgcmVnaXN0ZXJzLmRsICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMuZGggID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5keCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVkeCA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yZHggPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5zaSAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVzaSA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yc2kgPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5kaSAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVkaSA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yZGkgPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5zcCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVzcCA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yc3AgPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5icCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVicCA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yYnAgPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5pcCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLmVpcCA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yaXAgPSBcInZhcmlhYmxlLTNcIjtcblxuICAgIHJlZ2lzdGVycy5jcyAgPSBcImtleXdvcmRcIjtcbiAgICByZWdpc3RlcnMuZHMgID0gXCJrZXl3b3JkXCI7XG4gICAgcmVnaXN0ZXJzLnNzICA9IFwia2V5d29yZFwiO1xuICAgIHJlZ2lzdGVycy5lcyAgPSBcImtleXdvcmRcIjtcbiAgICByZWdpc3RlcnMuZnMgID0gXCJrZXl3b3JkXCI7XG4gICAgcmVnaXN0ZXJzLmdzICA9IFwia2V5d29yZFwiO1xuICB9XG5cbiAgZnVuY3Rpb24gYXJtdjYoX3BhcnNlckNvbmZpZykge1xuICAgIC8vIFJlZmVyZW5jZTpcbiAgICAvLyBodHRwOi8vaW5mb2NlbnRlci5hcm0uY29tL2hlbHAvdG9waWMvY29tLmFybS5kb2MucXJjMDAwMWwvUVJDMDAwMV9VQUwucGRmXG4gICAgLy8gaHR0cDovL2luZm9jZW50ZXIuYXJtLmNvbS9oZWxwL3RvcGljL2NvbS5hcm0uZG9jLmRkaTAzMDFoL0RESTAzMDFIX2FybTExNzZqemZzX3IwcDdfdHJtLnBkZlxuICAgIGxpbmVDb21tZW50U3RhcnRTeW1ib2wgPSBcIkBcIjtcbiAgICBkaXJlY3RpdmVzLnN5bnRheCA9IFwiYnVpbHRpblwiO1xuXG4gICAgcmVnaXN0ZXJzLnIwICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMucjEgID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5yMiAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLnIzICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMucjQgID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5yNSAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLnI2ICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMucjcgID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5yOCAgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLnI5ICA9IFwidmFyaWFibGVcIjtcbiAgICByZWdpc3RlcnMucjEwID0gXCJ2YXJpYWJsZVwiO1xuICAgIHJlZ2lzdGVycy5yMTEgPSBcInZhcmlhYmxlXCI7XG4gICAgcmVnaXN0ZXJzLnIxMiA9IFwidmFyaWFibGVcIjtcblxuICAgIHJlZ2lzdGVycy5zcCAgPSBcInZhcmlhYmxlLTJcIjtcbiAgICByZWdpc3RlcnMubHIgID0gXCJ2YXJpYWJsZS0yXCI7XG4gICAgcmVnaXN0ZXJzLnBjICA9IFwidmFyaWFibGUtMlwiO1xuICAgIHJlZ2lzdGVycy5yMTMgPSByZWdpc3RlcnMuc3A7XG4gICAgcmVnaXN0ZXJzLnIxNCA9IHJlZ2lzdGVycy5scjtcbiAgICByZWdpc3RlcnMucjE1ID0gcmVnaXN0ZXJzLnBjO1xuXG4gICAgY3VzdG9tLnB1c2goZnVuY3Rpb24oY2gsIHN0cmVhbSkge1xuICAgICAgaWYgKGNoID09PSAnIycpIHtcbiAgICAgICAgc3RyZWFtLmVhdFdoaWxlKC9cXHcvKTtcbiAgICAgICAgcmV0dXJuIFwibnVtYmVyXCI7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICB2YXIgYXJjaCA9IChwYXJzZXJDb25maWcuYXJjaGl0ZWN0dXJlIHx8IFwieDg2XCIpLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChhcmNoID09PSBcIng4NlwiKSB7XG4gICAgeDg2KHBhcnNlckNvbmZpZyk7XG4gIH0gZWxzZSBpZiAoYXJjaCA9PT0gXCJhcm1cIiB8fCBhcmNoID09PSBcImFybXY2XCIpIHtcbiAgICBhcm12NihwYXJzZXJDb25maWcpO1xuICB9XG5cbiAgZnVuY3Rpb24gbmV4dFVudGlsVW5lc2NhcGVkKHN0cmVhbSwgZW5kKSB7XG4gICAgdmFyIGVzY2FwZWQgPSBmYWxzZSwgbmV4dDtcbiAgICB3aGlsZSAoKG5leHQgPSBzdHJlYW0ubmV4dCgpKSAhPSBudWxsKSB7XG4gICAgICBpZiAobmV4dCA9PT0gZW5kICYmICFlc2NhcGVkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGVzY2FwZWQgPSAhZXNjYXBlZCAmJiBuZXh0ID09PSBcIlxcXFxcIjtcbiAgICB9XG4gICAgcmV0dXJuIGVzY2FwZWQ7XG4gIH1cblxuICBmdW5jdGlvbiBjbGlrZUNvbW1lbnQoc3RyZWFtLCBzdGF0ZSkge1xuICAgIHZhciBtYXliZUVuZCA9IGZhbHNlLCBjaDtcbiAgICB3aGlsZSAoKGNoID0gc3RyZWFtLm5leHQoKSkgIT0gbnVsbCkge1xuICAgICAgaWYgKGNoID09PSBcIi9cIiAmJiBtYXliZUVuZCkge1xuICAgICAgICBzdGF0ZS50b2tlbml6ZSA9IG51bGw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgbWF5YmVFbmQgPSAoY2ggPT09IFwiKlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIFwiY29tbWVudFwiO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBzdGFydFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRva2VuaXplOiBudWxsXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICB0b2tlbjogZnVuY3Rpb24oc3RyZWFtLCBzdGF0ZSkge1xuICAgICAgaWYgKHN0YXRlLnRva2VuaXplKSB7XG4gICAgICAgIHJldHVybiBzdGF0ZS50b2tlbml6ZShzdHJlYW0sIHN0YXRlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHN0cmVhbS5lYXRTcGFjZSgpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgc3R5bGUsIGN1ciwgY2ggPSBzdHJlYW0ubmV4dCgpO1xuXG4gICAgICBpZiAoY2ggPT09IFwiL1wiKSB7XG4gICAgICAgIGlmIChzdHJlYW0uZWF0KFwiKlwiKSkge1xuICAgICAgICAgIHN0YXRlLnRva2VuaXplID0gY2xpa2VDb21tZW50O1xuICAgICAgICAgIHJldHVybiBjbGlrZUNvbW1lbnQoc3RyZWFtLCBzdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNoID09PSBsaW5lQ29tbWVudFN0YXJ0U3ltYm9sKSB7XG4gICAgICAgIHN0cmVhbS5za2lwVG9FbmQoKTtcbiAgICAgICAgcmV0dXJuIFwiY29tbWVudFwiO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2ggPT09ICdcIicpIHtcbiAgICAgICAgbmV4dFVudGlsVW5lc2NhcGVkKHN0cmVhbSwgJ1wiJyk7XG4gICAgICAgIHJldHVybiBcInN0cmluZ1wiO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2ggPT09ICcuJykge1xuICAgICAgICBzdHJlYW0uZWF0V2hpbGUoL1xcdy8pO1xuICAgICAgICBjdXIgPSBzdHJlYW0uY3VycmVudCgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHN0eWxlID0gZGlyZWN0aXZlc1tjdXJdO1xuICAgICAgICByZXR1cm4gc3R5bGUgfHwgbnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKGNoID09PSAnPScpIHtcbiAgICAgICAgc3RyZWFtLmVhdFdoaWxlKC9cXHcvKTtcbiAgICAgICAgcmV0dXJuIFwidGFnXCI7XG4gICAgICB9XG5cbiAgICAgIGlmIChjaCA9PT0gJ3snKSB7XG4gICAgICAgIHJldHVybiBcImJyYWNrZXRcIjtcbiAgICAgIH1cblxuICAgICAgaWYgKGNoID09PSAnfScpIHtcbiAgICAgICAgcmV0dXJuIFwiYnJhY2tldFwiO1xuICAgICAgfVxuXG4gICAgICBpZiAoL1xcZC8udGVzdChjaCkpIHtcbiAgICAgICAgaWYgKGNoID09PSBcIjBcIiAmJiBzdHJlYW0uZWF0KFwieFwiKSkge1xuICAgICAgICAgIHN0cmVhbS5lYXRXaGlsZSgvWzAtOWEtZkEtRl0vKTtcbiAgICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgICAgfVxuICAgICAgICBzdHJlYW0uZWF0V2hpbGUoL1xcZC8pO1xuICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgIH1cblxuICAgICAgaWYgKC9cXHcvLnRlc3QoY2gpKSB7XG4gICAgICAgIHN0cmVhbS5lYXRXaGlsZSgvXFx3Lyk7XG4gICAgICAgIGlmIChzdHJlYW0uZWF0KFwiOlwiKSkge1xuICAgICAgICAgIHJldHVybiAndGFnJztcbiAgICAgICAgfVxuICAgICAgICBjdXIgPSBzdHJlYW0uY3VycmVudCgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHN0eWxlID0gcmVnaXN0ZXJzW2N1cl07XG4gICAgICAgIHJldHVybiBzdHlsZSB8fCBudWxsO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1c3RvbS5sZW5ndGg7IGkrKykge1xuICAgICAgICBzdHlsZSA9IGN1c3RvbVtpXShjaCwgc3RyZWFtLCBzdGF0ZSk7XG4gICAgICAgIGlmIChzdHlsZSkge1xuICAgICAgICAgIHJldHVybiBzdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBsaW5lQ29tbWVudDogbGluZUNvbW1lbnRTdGFydFN5bWJvbCxcbiAgICBibG9ja0NvbW1lbnRTdGFydDogXCIvKlwiLFxuICAgIGJsb2NrQ29tbWVudEVuZDogXCIqL1wiXG4gIH07XG59KTtcblxufSk7XG4iLCIvLyAuLiBDb3B5cmlnaHQgKEMpIDIwMTcgQnJ5YW4gQS4gSm9uZXMuXG4vL1xuLy8gICAgVGhpcyBmaWxlIGlzIHBhcnQgb2YgRS1Cb29rIEJpbmRlci5cbi8vXG4vLyAgICBFLUJvb2sgQmluZGVyIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXRcbi8vICAgIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlXG4vLyAgICBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pXG4vLyAgICBhbnkgbGF0ZXIgdmVyc2lvbi5cbi8vXG4vLyAgICBFLUJvb2sgQmluZGVyIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUXG4vLyAgICBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTU1xuLy8gICAgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZVxuLy8gICAgZGV0YWlscy5cbi8vXG4vLyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZ1xuLy8gICAgd2l0aCBFLUJvb2sgQmluZGVyLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LlxuLy9cbi8vIC4uIGhpZ2hsaWdodDo6IGphdmFzY3JpcHRcbi8vXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuLy8gfGRvY25hbWV8IC0gSmF2YVNjcmlwdCBmdW5jdGlvbnMgc3VwcG9ydGluZyBpbW1lZGlhdGUgZmVlZGJhY2sgdG8gaW4tYnJvd3NlciBxdWVzdGlvbnNcbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cblwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUnVuZXN0b25lQmFzZSBmcm9tIFwiLi4vLi4vY29tbW9uL2pzL3J1bmVzdG9uZWJhc2VcIjtcbmltcG9ydCBDb2RlTWlycm9yIGZyb20gXCJjb2RlbWlycm9yXCI7XG5pbXBvcnQgXCJjb2RlbWlycm9yL21vZGUvZ2FzL2dhcy5qc1wiO1xuaW1wb3J0IFwiY29kZW1pcnJvci9tb2RlL3B5dGhvbi9weXRob24uanNcIjtcbmltcG9ydCBcImNvZGVtaXJyb3IvbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanNcIjtcbmltcG9ydCBcImNvZGVtaXJyb3IvbW9kZS9zcWwvc3FsLmpzXCI7XG5pbXBvcnQgXCJjb2RlbWlycm9yL21vZGUvY2xpa2UvY2xpa2UuanNcIjtcbmltcG9ydCBcImNvZGVtaXJyb3IvbW9kZS9vY3RhdmUvb2N0YXZlLmpzXCI7XG5pbXBvcnQgXCJjb2RlbWlycm9yL2xpYi9jb2RlbWlycm9yLmNzc1wiO1xuXG4vLyBDb25zdHJ1Y3RvclxuLy8gPT09PT09PT09PT1cbi8vIE9iamVjdCBjb250YWluaW5nIGFsbCBpbnN0YW5jZXMgb2YgTFAgcHJvYmxlbXMuIChJIGFzc3VtZSB0aGVyZSBpcyBqdXN0IG9uZSBwZXIgcGFnZS4pXG53aW5kb3cuTFBMaXN0ID0ge307XG5cbi8vIEZJVEIgY29uc3RydWN0b3JcbmNsYXNzIExQIGV4dGVuZHMgUnVuZXN0b25lQmFzZSB7XG4gICAgY29uc3RydWN0b3Iob3B0cykge1xuICAgICAgICBzdXBlcihvcHRzKTtcbiAgICAgICAgdGhpcy51c2VSdW5lc3RvbmVTZXJ2aWNlcyA9IG9wdHMudXNlUnVuZXN0b25lU2VydmljZXM7XG4gICAgICAgIC8vIFN0b3JlIHRoZSBET00gZWxlbWVudCAodGhlIGlucHV0KSBmb3IgdGhlIFwiVGVzdFwiIGJ1dHRvbi5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gb3B0cy5vcmlnO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckRpdiA9IHRoaXMuZWxlbWVudDtcbiAgICAgICAgdGhpcy5kaXZpZCA9IHRoaXMuZWxlbWVudC5pZDtcbiAgICAgICAgLy8gU3RvcmUgdGhlIERPTSBlbGVtZW50ICh0aGUgdGV4dGFyZWEpIHdoZXJlIGNvbXBpbGUgcmVzdWx0cyB3aWxsIGJlIGRpc3BsYXllZC5cbiAgICAgICAgdGhpcy5yZXN1bHRFbGVtZW50ID0gJCh0aGlzLmVsZW1lbnQpLnNpYmxpbmdzKFwiLmxwLXJlc3VsdFwiKTtcbiAgICAgICAgLy8gU3RvcmUgdGhlIERPTSBlbGVtZW50IChhIGRpdikgd2hlcmUgZmVlZGJhY2sgd2lsbCBiZSBkaXNwbGF5ZWQuXG4gICAgICAgIHRoaXMuZmVlZGJhY2tFbGVtZW50ID0gJCh0aGlzLmVsZW1lbnQpXG4gICAgICAgICAgICAuc2libGluZ3MoXCIubHAtZmVlZGJhY2tcIilcbiAgICAgICAgICAgIC5jaGlsZHJlbihcImRpdlwiKTtcbiAgICAgICAgLy8gVXNlIGEgbmljZSBlZGl0b3IuXG4gICAgICAgIHRoaXMudGV4dEFyZWFzID0gW107XG4gICAgICAgIHRoaXMuaW5pdFRleHRBcmVhcygpO1xuICAgICAgICAvLyBIYW5kbGUgY2xpY2tzIHRvIHRoZSBcIlNhdmUgYW5kIHJ1blwiIGJ1dHRvbi5cbiAgICAgICAgbGV0IHRoYXQgPSB0aGlzO1xuICAgICAgICAkKHRoaXMuZWxlbWVudCkuY2xpY2soKGV2ZW50T2JqZWN0KSA9PlxuICAgICAgICAgICAgdGhhdC5vblNhdmVBbmRSdW4oZXZlbnRPYmplY3QpLnRoZW4obnVsbClcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5jaGVja1NlcnZlcihcImxwX2J1aWxkXCIsIHRydWUpO1xuICAgIH1cblxuICAgIC8vIExvb2sgZm9yIGVhY2ggY29kZSBzbmlwcGV0IChhIHRleHRhcmVhKS4gTWFrZSBpdCBhIG5pY2UgQ29kZU1pcnJvciBlZGl0b3IuXG4gICAgaW5pdFRleHRBcmVhcyhpc19yZWFkX29ubHkgPSBmYWxzZSkge1xuICAgICAgICBsZXQgdGhhdCA9IHRoaXM7XG4gICAgICAgIC8vIFNlbGVjdCBvbmx5IHRleHRhcmVhcyB0aGF0IGhhdmVuJ3QgYmVlbiBpbml0aWFsaXplZCB3aXRoIENvZGVNaXJyb3IgKHdoaWNoIHNldHMgc3R5bGU9XCJkaXNwbGF5Om5vbmVcIiBvbiB0aGUgdGV4dGFyZWEpLlxuICAgICAgICAkKCd0ZXh0YXJlYS5jb2RlX3NuaXBwZXQ6bm90KFtzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCJdKScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgICAgICBsZXQgZWRpdG9yID0gQ29kZU1pcnJvci5mcm9tVGV4dEFyZWEoZWxlbWVudCwge1xuICAgICAgICAgICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLFxuICAgICAgICAgICAgICAgIG1vZGU6ICQodGhhdC5lbGVtZW50KS5hdHRyKFwiZGF0YS1sYW5nXCIpLFxuICAgICAgICAgICAgICAgIGluZGVudFVuaXQ6IDQsXG4gICAgICAgICAgICAgICAgbWF0Y2hCcmFja2V0czogdHJ1ZSxcbiAgICAgICAgICAgICAgICByZWFkT25seTogaXNfcmVhZF9vbmx5LFxuICAgICAgICAgICAgICAgIGF1dG9NYXRjaFBhcmVuczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBleHRyYUtleXM6IHsgVGFiOiBcImluZGVudE1vcmVcIiwgXCJTaGlmdC1UYWJcIjogXCJpbmRlbnRMZXNzXCIgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gTWFrZSB0aGUgZWRpdG9yIHJlc2l6YWJsZS5cbiAgICAgICAgICAgICQoZWRpdG9yLmdldFdyYXBwZXJFbGVtZW50KCkpLnJlc2l6YWJsZSh7XG4gICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTaXplKCQodGhpcykud2lkdGgoKSwgJCh0aGlzKS5oZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gS2VlcCB0cmFjayBvZiBpdC5cbiAgICAgICAgICAgIHRoYXQudGV4dEFyZWFzLnB1c2goZWRpdG9yKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gRGF0YSBzdHJ1Y3R1cmVzOlxuICAgIC8vXG4gICAgLy8gRm9ybWF0IG9mIGRhdGEgc3RvcmVkIGxvY2FsbHkgYW5kIG9uIHRoZSBzZXJ2ZXIqOjpcbiAgICAvL1xuICAgIC8vICAtICAgYW5zd2VyOiBKU09OLWVuY29kZWQgc3RyaW5nIGNvbnRhaW5pbmcge1xuICAgIC8vICAgICAgICAgIGNvZGVfc25pcHBldHM6IFtcbiAgICAvLyAgICAgICAgICAgICAgc3RyLCBzbmlwcGV0IDEsIC4uLlxuICAgIC8vICAgICAgICAgIF0sXG4gICAgLy8gICAgICAgICAgKG9wdGlvbmFsKSByZXN1bHRTdHJpbmc6IHN0ciwgb3V0cHV0IGZyb20gYnVpbGQuXG4gICAgLy8gICAgICB9XG4gICAgLy8gIC0gICBjb3JyZWN0OiAob3B0aW9uYWwpIGZsb2F0LCBhIHBlcmNlbnRhZ2UgZnJvbSAwIHRvIDEwMC5cbiAgICAvLyAgLSAgIHRpbWVzdGFtcDogZGF0ZS90aW1lIGluIFVUQy5cbiAgICAvL1xuICAgIC8vIEZvcm1hdCBvZiBkYXRhIHNlbnQgdG8gdGhlIHNlcnZlcio6OlxuICAgIC8vXG4gICAgLy8gIC0gICBhbnN3ZXI6IEpTT04tZW5jb2RlZCBzdHJpbmcgY29udGFpbmluZyBvbmx5IHRoZSBjb2RlX3NuaXBwZXRzXG4gICAgLy8gICAgICAgICAgYXJyYXksIG5vdCByZXN1bHRTdHJpbmcuIFRoZXJlJ3Mgbm8gcG9pbnQgaW4gc2VuZGluZyB0aGVcbiAgICAvLyAgICAgICAgICBwcmV2aW91cyByZXN1bHRTdHJpbmcsIHNpbmNlIHRoZSBzZXJ2ZXIgd2lsbCBjb21wdXRlIGEgbmV3XG4gICAgLy8gICAgICAgICAgb25lLlxuICAgIC8vICAtICAgZXZlbnQ6IFwibHBfYnVpbGRcIlxuICAgIC8vICAtICAgYWN0OiBcIlwiLCBzaW5jZSB0aGUgdXNlaW5mbyB0YWJsZSByZXF1aXJlcyBpdC4gSXQncyBub3RcbiAgICAvLyAgICAgICAgICBvdGhlcndpc2UgdXNlZC5cbiAgICAvLyAgLSAgIHBhdGg6IHN0ciwgZ2l2aW5nIHRoZSByZWxhdGl2ZSBwYXRoIHRvIHRoaXMgd2ViIHBhZ2UuIFVzZWRcbiAgICAvLyAgICAgICAgICB0byBmaW5kIHRoZSBzb3VyY2UgY29kZSB3aGljaCBwcm9kdWNlZCB0aGlzIHBhZ2UgaW4gb3JkZXJcbiAgICAvLyAgICAgICAgICB0byBkbyBzbmlwcGV0IHJlcGxhY2VtZW50LlxuICAgIC8vICAtICAgZGl2X2lkOiBzdHIsIHRoZSBkaXZfaWQgb2YgdGhpcyBjb21wb25lbnQuXG4gICAgLy9cbiAgICAvLyBGb3JtYXQgb2YgZGF0YSByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXI6OlxuICAgIC8vXG4gICAgLy8gIElmIHRoZXJlIHdhcyBhbiBlcnJvcjpcbiAgICAvLyAgLSAgIGVycm9yczogW1xuICAgIC8vICAgICAgICAgIHN0ciwgZXJyb3IgbWVzc2FnZSAxLCAuLi5cbiAgICAvLyAgICAgIF1cbiAgICAvL1xuICAgIC8vICBPdGhlcndpc2U6XG4gICAgLy8gIC0gICBhbnN3ZXI6IEpTT04tZW5jb2RlZCBzdHJpbmcgY29udGFpbmluZyB7XG4gICAgLy8gICAgICAgICAgcmVzdWx0U3RyaW5nOiBzdHIsIG91dHB1dCBmcm9tIGJ1aWxkLlxuICAgIC8vICAgICAgICAgIE5vdGUgdGhhdCB0aGUgY29kZV9zbmlwcGV0cyBhcmVuJ3Qgc2VudCBiYWNrLCB0byBzYXZlXG4gICAgLy8gICAgICAgICAgICAgIGJhbmR3aWR0aC5cbiAgICAvLyAgICAgIH1cbiAgICAvLyAgLSAgIGNvcnJlY3Q6IGZsb2F0LCBhIHBlcmNlbnRhZ2UgZnJvbSAwIHRvIDEwMC5cbiAgICAvLyAgLSAgIHRpbWVzdGFtcDogc3RyLCB0aGUgc2VydmVyJ3MgdGltZXN0YW1wLlxuICAgIC8vXG4gICAgLy8gKiBGb3Igc2ltcGxpY2l0eSwgSSBvbWl0dGVkIHRoZSBjb21tb24gZmllbGRzIChjb3Vyc2UsIGV0Yy4pIGFuZCBkaXNjdXNzZWQgb25seSBmaWVsZHMgdW5pcXVlIHRvIHRoaXMgY29tcG9uZW50LlxuXG4gICAgYXN5bmMgb25TYXZlQW5kUnVuKF9ldmVudE9iamVjdCkge1xuICAgICAgICAvLyBQcmV2ZW50IG11bHRpcGxlIGNsaWNrIHdoaWxlIHRoZSBidWlsZCBpcyBydW5uaW5nLlxuICAgICAgICAkKHRoaXMuZWxlbWVudCkuYXR0cihcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICAkKHRoaXMucmVzdWx0RWxlbWVudCkudmFsKFwiQnVpbGRpbmcuLi5cIik7XG4gICAgICAgICQodGhpcy5mZWVkYmFja0VsZW1lbnQpLnRleHQoXCJcIikuYXR0cihcIlwiKTtcbiAgICAgICAgLy8gU2luY2UgdGhlIFNhdmUgYW5kIHJ1biBidXR0b24gd2FzIGNsaWNrZWQsIHdlIGFzc3VtZSB0aGUgY29kZSBzbmlwcGV0cyBoYXZlIGJlZW4gY2hhbmdlZDsgdGhlcmVmb3JlLCBkb24ndCBzdG9yZSBgYGNvcnJlY3RgYCBvciBgYGFuc3dlci5yZXN1bHRTdHJpbmdgYCBiZWNhdXNlIHRoZXkgYXJlIG91dCBvZiBkYXRlLlxuICAgICAgICAvL1xuICAgICAgICAvLyBTdG9yZSB0aGUgYW5zd2VyIGFzIGEgc3RyaW5nLCBzaW5jZSB0aGlzIGlzIHdoYXQgZ29lcyBpbiB0byAvIGNvbWVzIG91dCBmcm9tIHRoZSBkYXRhYmFzZS4gV2UgaGF2ZSB0byB0cmFuc2xhdGUgdGhpcyBiYWNrIHRvIGEgZGF0YSBzdHJ1Y3R1cmUgd2hlbiByZXN0b3JpbmcgZnJvbSB0aGUgZGIgb3IgbG9jYWwgc3RvcmFnZS5cbiAgICAgICAgbGV0IGNvZGVfc25pcHBldHMgPSB0aGlzLnRleHRhcmVhc1RvRGF0YSgpO1xuICAgICAgICB0aGlzLnNldExvY2FsU3RvcmFnZSh7XG4gICAgICAgICAgICBhbnN3ZXI6IHsgY29kZV9zbmlwcGV0czogY29kZV9zbmlwcGV0cyB9LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gU3RvcmUgdGhlIGFuc3dlciB0aGF0IHRoZSBzZXJ2ZXIgcmV0dXJucywgd2hpY2ggaW5jbHVkZXMgYWRkaXRpb25hbCBkYXRhIChjb3JyZWN0L2luY29ycmVjdCwgZmVlZGJhY2sgZnJvbSB0aGUgYnVpbGQsIGV0Yy4pLlxuICAgICAgICBsZXQgc2VydmVyQW5zd2VyO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2VydmVyQW5zd2VyID0gYXdhaXQgdGhpcy5sb2dCb29rRXZlbnQoe1xuICAgICAgICAgICAgICAgIGV2ZW50OiBcImxwX2J1aWxkXCIsXG4gICAgICAgICAgICAgICAgYW5zd2VyOiBKU09OLnN0cmluZ2lmeShjb2RlX3NuaXBwZXRzKSxcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHJlcXVpcmVkIGJ5IHVzZWluZm8sIGJ1dCBub3QgdXNlZC5cbiAgICAgICAgICAgICAgICBhY3Q6IFwiXCIsXG4gICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgcmVsYXRpdmUgcGF0aCB0byB0aGlzIHdlYiBwYWdlLiBTbGljZSBvZmYgdGhlIGxlYWRpbmcgYGAvYGAuXG4gICAgICAgICAgICAgICAgcGF0aDogd2luZG93LmxvY2F0aW9uLmhyZWZcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoZUJvb2tDb25maWcuYXBwLCBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAuc2xpY2UoMSksXG4gICAgICAgICAgICAgICAgZGl2X2lkOiB0aGlzLmRpdmlkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgJCh0aGlzLmZlZWRiYWNrRWxlbWVudClcbiAgICAgICAgICAgICAgICAudmFsKGBFcnJvciBjb250YWN0aW5nIHNlcnZlcjoge2Vycn0uYClcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYWxlcnQgYWxlcnQtZGFuZ2VyXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgLy8gQWx3YXlzIHJlLWVuYWJsZSB0aGUgYnV0dG9uIGFmdGVyIHRoZSBzZXJ2ZXIgcmVzcG9uZHMuXG4gICAgICAgICAgICAkKHRoaXMuZWxlbWVudCkuYXR0cihcImRpc2FibGVkXCIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2ZXJBbnN3ZXIgPSBzZXJ2ZXJBbnN3ZXIuZGV0YWlsO1xuICAgICAgICAvLyBUaGUgc2VydmVyIGRvZXNuJ3QgcmV0dXJuIHRoZSBgYGNvZGVfc25pcHBldHNgYCwgZm9yIGVmZmljaWVuY3kuIEluY2x1ZGUgdGhvc2UuIElmIGFuIGVycm9yIHdhcyByZXR1cm5lZCwgbm90ZSB0aGF0IHRoZXJlIGlzIG5vIGBgYW5zd2VyYGAgeWV0LlxuICAgICAgICBpZiAoIShcImFuc3dlclwiIGluIHNlcnZlckFuc3dlcikpIHtcbiAgICAgICAgICAgIHNlcnZlckFuc3dlci5hbnN3ZXIgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBzZXJ2ZXJBbnN3ZXIuYW5zd2VyLmNvZGVfc25pcHBldHMgPSBjb2RlX3NuaXBwZXRzO1xuICAgICAgICB0aGlzLmRpc3BsYXlBbnN3ZXIoc2VydmVyQW5zd2VyKTtcbiAgICAgICAgdGhpcy5zZXRMb2NhbFN0b3JhZ2Uoc2VydmVyQW5zd2VyKTtcbiAgICB9XG5cbiAgICAvLyBHaXZlbiBhIHNpbmdsZSBhbnN3ZXIsIGRpc3BsYXkgaXQuXG4gICAgZGlzcGxheUFuc3dlcihkYXRhKSB7XG4gICAgICAgIGlmIChcImVycm9yc1wiIGluIGRhdGEpIHtcbiAgICAgICAgICAgIC8vIERpc3BsYXkgYW55IHNlcnZlci1zaWRlIGVycm9ycy4gSWYgdGhpcyBrZXkgaXMgcHJlc2VudCwgb3RoZXIga2V5cyB3b24ndCBiZS5cbiAgICAgICAgICAgICQodGhpcy5mZWVkYmFja0VsZW1lbnQpXG4gICAgICAgICAgICAgICAgLnRleHQoZGF0YS5lcnJvcnMuam9pbihcIjxicj5cIikpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImFsZXJ0IGFsZXJ0LWRhbmdlclwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIERpc3BsYXkgYW5kIGNvbG9yLWNvZGUgdGhlIHJlc3VsdHMuXG4gICAgICAgICAgICAkKHRoaXMucmVzdWx0RWxlbWVudCkudmFsKGRhdGEuYW5zd2VyLnJlc3VsdFN0cmluZyk7XG4gICAgICAgICAgICBpZiAoZGF0YS5jb3JyZWN0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMuZmVlZGJhY2tFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAudGV4dChcIlJlc3BvbnNlIHJlY29yZGVkLlwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYWxlcnQgYWxlcnQtc3VjY2Vzc1wiKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jb3JyZWN0ID49IDEwMCkge1xuICAgICAgICAgICAgICAgICQodGhpcy5mZWVkYmFja0VsZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0KFwiQ29ycmVjdC4gR3JhZGU6IFwiICsgZGF0YS5jb3JyZWN0ICsgXCIlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbGVydCBhbGVydC1zdWNjZXNzXCIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMuZmVlZGJhY2tFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAudGV4dChcIkluY29ycmVjdC4gR3JhZGU6IFwiICsgZGF0YS5jb3JyZWN0ICsgXCIlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbGVydCBhbGVydC1kYW5nZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBTY3JvbGwgdG8gdGhlIGJvdHRvbSBvZiB0aGUgcmVzdWx0cy5cbiAgICAgICAgICAgICQodGhpcy5yZXN1bHRFbGVtZW50KS5zY3JvbGxUb3AodGhpcy5yZXN1bHRFbGVtZW50WzBdLnNjcm9sbEhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTdG9yZSB0aGUgY29udGVudHMgb2YgZWFjaCB0ZXh0YXJlYSBpbnRvIGFuIGFycmF5IG9mIHN0cmluZ3MuXG4gICAgdGV4dGFyZWFzVG9EYXRhKCkge1xuICAgICAgICByZXR1cm4gJC5tYXAodGhpcy50ZXh0QXJlYXMsIGZ1bmN0aW9uIChvYmosIGluZGV4KSB7XG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9jb2RlbWlycm9yLm5ldC9kb2MvbWFudWFsLmh0bWwjYXBpLlxuICAgICAgICAgICAgcmV0dXJuIG9iai5nZXRWYWx1ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTdG9yZSBhbiBhcnJheSBvZiBzdHJpbmdzIGluIGBgZGF0YS5jb2RlX3NuaXBwZXRzYGAgaW50byBlYWNoIHRleHRhcmVhLlxuICAgIGRhdGFUb1RleHRhcmVhcyhkYXRhKSB7XG4gICAgICAgIC8vIEZvciBwbGFjZXMgd2hlcmUgdGV4dGFyZWFzIGFyZW4ndCBwcm92aWRlZCAoaW5zdHJ1Y3RvciBncmFkaW5nIGludGVyZmFjZSwgYXNzaWdubWVudCBwYWdlKSwgY3JlYXRlIHRoZW0uIEhvd2V2ZXIsIHRoZXNlIGFyZW4ndCBydW5uYWJsZSwgc28gZGlzYWJsZSB0aGUgXCJTYXZlIGFuZCBydW5cIiBidXR0b24uIEFzc3VtZSB0aGlzIGlzIHRoZSBjYXNlIHdoZW4gdGhlcmUgYXJlIG5vIHRleHRhcmVhcy4gUmVhc29uaW5nOiB0aGUgcGFnZSBjb250YWluaW5nIHRoZSBwcm9ibGVtIGNvbnRhaW5zIGNvZGUgaW50ZW5kZWQgdG8gYmUgaW50ZXJtaW5nbGVkIHdpdGggdGhlIHN0dWRlbnQncyBhbnN3ZXIuIElmIHRoYXQncyBub3QgcHJlc2VudCwgd2UgY2FuJ3QgYnVpbGQuXG4gICAgICAgIGlmICghdGhpcy50ZXh0QXJlYXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBUaGUgdW51c3VhbCBjYXNlIC0tIGEgcHJvYmxlbSBub3Qgb24gaXRzIG9yaWdpbmFsIHBhZ2UuIENyZWF0ZSB0ZXh0YXJlYXMgdG8gZGlzcGxheSB0aGUgY29kZSwgdGhlbiBpbml0aWFsaXplIHRoZW0uIE5vdGUgdGhhdCB3ZSBjYW4ndCBzaW1wbHkgY3JlYXRlIHRoZXNlIGluIHRoZSBjb25zdHJ1Y3RvciAod2hpY2ggd291bGQgYmUgY29udmVuaWVudCkgc2luY2Ugd2UgZG9uJ3QgeWV0IGtub3cgaG93IG1hbnkgY29kZSBzbmlwcGV0cyBhcmUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm9ibGVtLlxuICAgICAgICAgICAgJCh0aGlzLmVsZW1lbnQpLmJlZm9yZSgoZGF0YS5hbnN3ZXIuY29kZV9zbmlwcGV0cyB8fCBbXSkubWFwKCgpID0+IGA8dGV4dGFyZWEgY2xhc3M9XCJjb2RlX3NuaXBwZXRcIj48L3RleHRhcmVhPjxiciAvPmApKTtcbiAgICAgICAgICAgIC8vIFB1dCBDb2RlTWlycm9yIGluIHJlYWQtb25seSBtb2RlLlxuICAgICAgICAgICAgdGhpcy5pbml0VGV4dEFyZWFzKHRydWUpO1xuICAgICAgICAgICAgLy8gRGlzYWJsZSB0aGUgXCJTYXZlIGFuZCBydW5cIiBidXR0b24uXG4gICAgICAgICAgICAkKHRoaXMuZWxlbWVudCkucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgLy8gTm93IHRoYXQgd2UgaGF2ZSB0ZXh0YXJlYXMsIGxldCB0aGUgdXN1YWwgY2FzZSBjb2RlIHJ1bi5cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRoZSB1c3VhbCBjYXNlIC0tIGEgcHJvYmxlbSBvbiBpdHMgb3JpZ2luYWwgcGFnZS4gRmluZCBhbGwgY29kZSBzbmlwcGV0IHRleHRhcmVhcy5cbiAgICAgICAgJCh0aGlzLnRleHRBcmVhcykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgICAgICAvLyBTaWxlbnRseSBpZ25vcmUgaWYgYGBkYXRhLmFuc3dlci5jb2RlX3NuaXBwZXRzYGAgb3IgYGBkYXRhLmFuc3dlci5jb2RlX3NuaXBwZXRzW2luZGV4XWBgIGlzbid0IGRlZmluZWQuXG4gICAgICAgICAgICB2YWx1ZS5zZXRWYWx1ZSgoZGF0YS5hbnN3ZXIuY29kZV9zbmlwcGV0cyB8fCBcIlwiKVtpbmRleF0gfHwgXCJcIik7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBDb3JuZXIgY2FzZSBUT0RPOiBpZiBhIHByb2JsZW0gaXMgZWRpdGVkIGFmdGVyIHN0dWRlbnRzIGFscmVhZHkgc3VibWl0IGNvZGUgc28gdGhhdCB0aGVyZSBhcmUgbm93IGZld2VyIHRleHRhcmVhcywgZGlzcGxheSB0aGVzZSBidXQgZG9uJ3Qgc2F2ZSB0aGVtIHdoZW4gXCJTYXZlIGFuZCBydW5cIiBpcyBwcmVzc2VkLiBUaGlzIGFsbG93cyBzdHVkZW50cyB0byAoaG9wZWZ1bGx5KSByZS11c2UgY29kZSBmcm9tIG5vdy1kaXNjYXJkZWQgdGV4dGFyZWFzLlxuICAgIH1cblxuICAgIC8vIFJlc3RvcmUgYW5zd2VycyBmcm9tIHN0b3JhZ2UgcmV0cmlldmFsIGRvbmUgaW4gUnVuZXN0b25lQmFzZS5cbiAgICByZXN0b3JlQW5zd2VycyhkYXRhKSB7XG4gICAgICAgIC8vIFdlIHN0b3JlIHRoZSBhbnN3ZXIgYXMgYSBKU09OLWVuY29kZWQgc3RyaW5nIGluIHRoZSBkYiAvIGxvY2FsIHN0b3JhZ2UuIFJlc3RvcmUgdGhlIGFjdHVhbCBkYXRhIHN0cnVjdHVyZSBmcm9tIGl0LiBBdm9pZCBleGNlcHRpb25zIGlmIG5vIGRhdGEgaXMgYXZhaWxhYmxlLlxuICAgICAgICBkYXRhLmFuc3dlciA9IEpTT04ucGFyc2UoZGF0YS5hbnN3ZXIgfHwgXCJ7fVwiKTtcbiAgICAgICAgdGhpcy5kYXRhVG9UZXh0YXJlYXMoZGF0YSk7XG4gICAgICAgIHRoaXMuZGlzcGxheUFuc3dlcihkYXRhKTtcbiAgICB9XG5cbiAgICBjaGVja0xvY2FsU3RvcmFnZSgpIHtcbiAgICAgICAgLy8gTG9hZHMgcHJldmlvdXMgYW5zd2VycyBmcm9tIGxvY2FsIHN0b3JhZ2UgaWYgdGhleSBleGlzdC5cbiAgICAgICAgdmFyIHN0b3JlZERhdGE7XG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMubG9jYWxTdG9yYWdlS2V5KCk7XG4gICAgICAgICAgICB2YXIgZXggPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmVkRGF0YSA9IEpTT04ucGFyc2UoZXgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvciB3aGlsZSBwYXJzaW5nOyBsaWtlbHkgZHVlIHRvIGJhZCB2YWx1ZSBzdG9yZWQgaW4gc3RvcmFnZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlQW5zd2VycyhzdG9yZWREYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldExvY2FsU3RvcmFnZShkYXRhKSB7XG4gICAgICAgIC8vIE1ha2UgYSBzaGFsbG93IGNvcHksIHNvIHdlIGNhbiBKU09OLWVuY29kZSB0aGUgY29kZSBzbmlwcGV0cyAobWF0Y2hpbmcgd2hhdCBjb21lcyBmcm9tIHRoZSBzZXJ2ZXIpIHdpdGhvdXQgY2hhbmdpbmcgdGhlIG9yaWdpbmFsIG9iamVjdC5cbiAgICAgICAgbGV0IGRhdGFfY2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcbiAgICAgICAgZGF0YV9jbG9uZS5hbnN3ZXIgPSAgSlNPTi5zdHJpbmdpZnkoZGF0YS5hbnN3ZXIpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmxvY2FsU3RvcmFnZUtleSgpLCBKU09OLnN0cmluZ2lmeShkYXRhX2Nsb25lKSk7XG4gICAgfVxufVxuXG4vLyBJbml0aWFsaXphdGlvblxuLy8gPT09PT09PT09PT09PT1cbi8vIEZpbmQgdGhlIGN1c3RvbSBIVE1MIHRhZ3MgYW5kIGV4ZWN1dGUgb3VyIGNvZGUgb24gdGhlbS5cbiQoZG9jdW1lbnQpLm9uKFwicnVuZXN0b25lOmxvZ2luLWNvbXBsZXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAkKFwiW2RhdGEtY29tcG9uZW50PWxwX2J1aWxkXVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgd2luZG93LkxQTGlzdFt0aGlzLmlkXSA9IG5ldyBMUCh7XG4gICAgICAgICAgICAgICAgb3JpZzogdGhpcyxcbiAgICAgICAgICAgICAgICB1c2VSdW5lc3RvbmVTZXJ2aWNlczogZUJvb2tDb25maWcudXNlUnVuZXN0b25lU2VydmljZXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgcmVuZGVyaW5nIExQIFByb2JsZW0gJHt0aGlzLmlkfWApO1xuICAgICAgICB9XG4gICAgfSk7XG59KTtcblxuaWYgKHR5cGVvZiB3aW5kb3cuY29tcG9uZW50X2ZhY3RvcnkgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICB3aW5kb3cuY29tcG9uZW50X2ZhY3RvcnkgPSB7fTtcbn1cbndpbmRvdy5jb21wb25lbnRfZmFjdG9yeVtcImxwX2J1aWxkXCJdID0gZnVuY3Rpb24gKG9wdHMpIHtcbiAgICByZXR1cm4gbmV3IExQKG9wdHMpO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==